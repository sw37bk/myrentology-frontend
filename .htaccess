RewriteEngine On

# API перенаправления
RewriteRule ^api/auth-login$ api/auth-login.php [L]
RewriteRule ^api/avito-settings$ api/avito-settings.php [L]
RewriteRule ^api/avito-user-status$ api/avito-user-status.php [L]
RewriteRule ^api/avito-oauth-start$ api/avito-oauth-start.php [L]
RewriteRule ^api/avito-oauth-callback$ api/avito-oauth-callback.php [L]
RewriteRule ^api/avito-token$ api/avito-token.php [L]
RewriteRule ^api/setup-avito$ api/setup-avito.php [L]
RewriteRule ^api/setup-avito-app$ api/setup-avito-app.php [L]
RewriteRule ^api/avito-personal-keys$ api/avito-personal-keys.php [L]
RewriteRule ^api/setup-personal-keys$ api/setup-personal-keys.php [L]
RewriteRule ^api/avito-chats$ api/avito-chats.php [L]
RewriteRule ^api/avito-ads$ api/avito-ads.php [L]
RewriteRule ^api/setup-avito-tables$ api/setup-avito-tables.php [L]
RewriteRule ^api/link-resource-avito$ api/link-resource-avito.php [L]
RewriteRule ^api/avito-messages$ api/avito-messages.php [L]

# CORS headers для API
<IfModule mod_headers.c>
    Header always set Access-Control-Allow-Origin "*"
    Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
    Header always set Access-Control-Allow-Headers "Content-Type, Authorization"
</IfModule>

# Исключаем API из SPA роутинга - пропускаем все запросы к /api/ напрямую
RewriteCond %{REQUEST_URI} ^/api/
RewriteRule ^(.*)$ - [L]

# SPA роутинг для всего остального
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.html [L]
RewriteEngine On

# API перенаправления на PHP файлы
RewriteRule ^api/auth/login$ api/auth/login.php [L]
RewriteRule ^api/auth-login$ api/auth/login.php [L]
RewriteRule ^api/avito-settings$ api/avito-settings.php [L]
RewriteRule ^api/avito-oauth-start$ api/avito-oauth-start.php [L]
RewriteRule ^api/avito-callback$ api/avito-callback.php [L]

# Отключаем статистику reg.ru для JS файлов
RewriteCond %{REQUEST_URI} \.(js|css)$ [NC]
RewriteRule .* - [E=nolog:1]

# SPA роутинг (исключаем API)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !^/api/
RewriteRule . /index.html [L]

# CORS headers
<IfModule mod_headers.c>
    Header always set Access-Control-Allow-Origin "*"
    Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
    Header always set Access-Control-Allow-Headers "Content-Type, Authorization"
</IfModule>

# Отключаем статистику reg.ru
<IfModule mod_env.c>
    SetEnv nolog 1
</IfModule>